<!--
    nerveBall is an online ball game in which the trajectories of the balls are modulated by a neural network.
    Copyright (C) 2024 Jaakko Prättälä

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <https://www.gnu.org/licenses/>.

-->
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>nerveBall</title>
        <link rel="stylesheet" type="text/css" href="nbwstyle.css" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.3/p5.js"></script>
        <script src="nerveballweb.js"></script>
    </head>
    <body>
        <script type="text/javascript">
            function checkMouse(){
                for (var i = 0; i < balls.length; i++){
                    console.log(dist(mouseX, mouseY, balls[i].x, balls[i].y));
                    if (dist(mouseX, mouseY, balls[i].x, balls[i].y) < balls[i].radius+7){
                        splitBall(i);
                        if (balls.length <=0){
                            levelUp();
                        }
                    }
                }
            }
            function setup(){
                cnv = createCanvas(cnvWidth, cnvHeight);
                cnv.mouseClicked(checkMouse);
                loop();
                setTimeout(function(){
                    showLevelUpText = false;
                }, 10000);
            }

            function draw(){
                background(0);

                if (showLevelUpText){
                    fill(0, 120, 170);
                    textSize(20);
                    text("Level: " + level, 200, 200);
                    text("Max balls: " + maxBalls, 200, 250);
                    text("Speed limit: " + maxSpeed, 200, 300);
                }

                if(!gameOn){
                    fill(0, 120, 170);
                    textSize(20);
                    text("Game over, you won!", 200, 200);
                }
                for (let i = 0; i < balls.length; i++){
                    balls[i].update();
                    fill(balls[i].na*255, 255-balls[i].na*127, balls[i].na*160);
                    ellipse(balls[i].x, balls[i].y, balls[i].radius*2, balls[i].radius*2);
                }
            }

        </script>
    </body>
</html>
