<!-- nerveBall Web Version copymiddle 2024 Jaakko Prättälä -->
<!DOCTYPE html>
<html>
    <head>
        <title>nerveBall</title>
        <link rel="stylesheet" type="text/css" href="nerveballweb.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
        <script src="nerveballweb.js"></script>
    </head>
    <body> 
        <script type="text/javascript">
            var mode = 0;
            function setup() {
                createCanvas(800, 800);
                background(0);
                fill(255);
                frameRate(60);
            }

            function draw() {
                //clear canvas
                background(0);

                //update ball neural activations
                countActivations();

                //backpropagate
                for (var i = 0; i < ball_amount; i++) {
                    backPropagate(i);
                }

                //move balls
                for (var i = 0; i < ball_amount; i++) {
                    moveBall(i);
                }
                
                //draw balls
                for (var i = 0; i < ball_amount; i++) {
                    fill(255-ball_size[i]*2, 255-ball_size[i]*3, 255);
                    ellipse(ball_x[i], ball_y[i], ball_size[i], ball_size[i]);
                }
                
                /* DEBUG
                //draw neural activations
                fill(0, 255, 0)
                for (var i = 0; i < ball_amount; i++) {
                    text(ball_na[i], ball_x[i], ball_y[i]);
                }*/
                //handle mouse input
                if (mouseIsPressed) {
                    for (var i = 0; i < ball_amount; i++) {
                        if (dist(mouseX, mouseY, ball_x[i], ball_y[i]) < ball_size[i] / 2) {
                            splitBall(i);
                        }
                    }
                }
            }

        </script>
    </body>
</html>
